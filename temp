Private Sub Worksheet_Change(ByVal Target As Range)
    MsgBox "Change Detected"
End Sub



Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)
    Dim ws As Worksheet: Set ws = Me
    If Intersect(Target, ws.Range("B4:C7")) Is Nothing Then Exit Sub

    Application.EnableEvents = False
    Application.ScreenUpdating = False

    Dim currentRow As Long: currentRow = 11
    Dim 通路 As Range, 年期 As Range
    Dim 範本範圍 As Range

    ' 清空舊輸出 (只到第100列)
    ws.Rows("11:100").ClearContents
    ws.Rows("11:100").ClearFormats

    ' 收集通路與年期的非空值
    Dim 通路清單 As String, 年期清單 As String
    For Each 通路 In ws.Range("B4:B7")
        If 通路.Value <> "" Then 通路清單 = 通路清單 & 通路.Value & ","
    Next
    For Each 年期 In ws.Range("C4:C7")
        If 年期.Value <> "" Then 年期清單 = 年期清單 & 年期.Value & ","
    Next

    ' 去掉尾巴的逗號
    If 通路清單 = "" Or 年期清單 = "" Then GoTo CleanExit
    通路清單 = Left(通路清單, Len(通路清單) - 1)
    年期清單 = Left(年期清單, Len(年期清單) - 1)

    Dim cArr() As String, yArr() As String
    cArr = Split(通路清單, ",")
    yArr = Split(年期清單, ",")

    ' 交叉組合
    Dim c As Variant, y As Variant
    For Each c In cArr
        For Each y In yArr
            Select Case Trim(c)
                Case "業務": Set 範本範圍 = ws.Range("B61:Y65")
                Case "經代": Set 範本範圍 = ws.Range("B66:Y70")
                Case "銀保": Set 範本範圍 = ws.Range("B71:Y79")
                Case "理財": Set 範本範圍 = ws.Range("B80:Y83")
                Case Else: GoTo Skip
            End Select
            範本範圍.Copy
            ws.Cells(currentRow, "B").PasteSpecial xlPasteAll
            currentRow = currentRow + 範本範圍.Rows.Count + 1
Skip:
        Next y
    Next c

CleanExit:
    Application.CutCopyMode = False
    Application.EnableEvents = True
    Application.ScreenUpdating = True
End Sub